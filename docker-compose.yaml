version: '3'

services:
  # Configuration for Hub+Proxy
  jupyterhub:
    build: .                # Build the container from this folder
    container_name: jupyterhub_hub   # The service will use this container name.
    volumes:                 # Give access to Docker socket.
      - /var/run/docker.sock:/var/run/docker.sock
      - jupyterhub_data:/srv/jupyterlab
      - ./jupyterhub-data:/persist
    environment:             # Env variables passed to the Hub process.
      DOCKER_NETWORK_NAME: jupyter_hub
      DOCKER_NOTEBOOK_DIR: /home/jovyan/work
    ports:
      - 7000:8000
    restart: unless-stopped  # Configuration for the single-user servers
    networks:
      - jupyter_hub_network

  jupyterlab:
    image: tensorflow/tensorflow:latest-gpu-jupyter
    command: echo
    networks:
      - jupyter_hub_network
    
volumes:
  jupyterhub_data:

networks:
  jupyter_hub_network:
    driver: bridge